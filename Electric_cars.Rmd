---
title: "R Notebook"
output: html_notebook
---
About this file
Data Fields:

- Battery: The capacity of the vehicle's battery in kilowatt-hours (kWh).

- Car_name: The model name of the electric vehicle.

- Car_name_link: A direct link to the corresponding page on EV Database for more in-depth information.

- Efficiency: The energy efficiency rating of the vehicle in watt-hours per kilometer (Wh/km).

- Fast_charge: The fast-charging capability of the vehicle in minutes for a certain charging percentage.

- Price.DE.:The price of the electric vehicle in Germany.

- Range: The driving range of the vehicle on a single charge in kilometers.

- Top_speed:The maximum speed the vehicle can achieve in kilometers per hour.

- Acceleration..0.100.: The acceleration time from 0 to 100 kilometers per hour.
```{r}
library(dplyr)
library(ggplot2)
library(tidyr)
library(car)
library(MASS)
```
```{r}
ecars_raw = read.csv('EV_cars.csv')
```


```{r}
ecars_raw$battery = ecars_raw$Battery
ecars_raw = ecars_raw[,2:10]
```

```{r}
make = strsplit(ecars_raw$Car_name, split = ' ')
make_ = c()
n = length(make)
n = c(1:n)
for (i in n) {
  make_[i] = make[[i]][1]
}
ecars_raw$Make = make_
ecars_raw
```
```{r}

ecars = ecars_raw %>% filter(!is.na(Price.DE.))

ecars %>% group_by(Make) %>%
  filter(n() > 5) %>%
  summarise(average_cost = mean(Price.DE.))

ecars %>% group_by(Make)%>%
  summarise(average_cost = mean(Price.DE.)) %>%
  arrange(average_cost) %>%
```

```{r}
plot(ecars[,3:9])
plot(ecars$acceleration..0.100., ecars$battery)
hist(ecars$Fast_charge) 
hist(ecars$Efficiency)
ecars$Price_pow = (ecars$Price.DE. ** -.5)
ecars$Speed_pow = (ecars$Top_speed ** .25)
ecars$Efficiency_pow = (ecars$Efficiency ** .25)
summary(ecars)
sapply(ecars, sd)
```
Colinearity with predicting Range based n battery

```{r}

RBmodel = lm(Range ~  battery, data = ecars)
summary(RBmodel)
plot(RBmodel) 

ATmodel = lm(Top_speed ~ acceleration..0.100., data = ecars)
summary(ATmodel)
plot(ATmodel)

model = lm(Price_pow ~ Efficiency_pow + Speed_pow + Fast_charge + Range, data = ecars)
summary(model) 

```
With transformation done to price 
```{r}

```





























This is an [R Markdown](http://rmarkdown.rstudio.com) Notebook. When you execute code within the notebook, the results appear beneath the code. 

Try executing this chunk by clicking the *Run* button within the chunk or by placing your cursor inside it and pressing *Ctrl+Shift+Enter*. 

```{r}
plot(cars)
```

Add a new chunk by clicking the *Insert Chunk* button on the toolbar or by pressing *Ctrl+Alt+I*.

When you save the notebook, an HTML file containing the code and output will be saved alongside it (click the *Preview* button or press *Ctrl+Shift+K* to preview the HTML file).

The preview shows you a rendered HTML copy of the contents of the editor. Consequently, unlike *Knit*, *Preview* does not run any R code chunks. Instead, the output of the chunk when it was last run in the editor is displayed.
