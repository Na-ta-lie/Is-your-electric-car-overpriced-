# box plot of any variable
#boxplot of any variable by Make
#histogram of variable
# bar graph of variable
# variable relationships
library(dplyr)
library(ggplot2)
library(tidyr)
library(car)
library(MASS)
library(repr)
library(pals)
library(shinythemes)
library(plotly)
library(bslib)
library(ggpubr)
library(revealjs)
library(shiny)
ecars = read.csv('ecars.csv')
ecars_vars = ecars[,4:10]
ecars_make  = ecars %>% group_by(Make) %>%
filter(n()>=10)
most_makes = read.csv('most_makes.csv')
predicted_price = read.csv('predicted_price.csv')
makes = most_makes$Make
ecars$Make2 = ifelse(ecars$Make %in% makes, ecars$Make, "zOther")
make_other = unique(ecars$Make2)
make_other = sort(make_other)
make_other[15] = 'Other'
price_model_initial = lm(Price ~ Efficiency + Fast_charge +
Range + Top_speed +
Acceleration, data = ecars)
bc = boxCox(price_model_initial)
lambda = bc$x[which(bc$y == max(bc$y))]
model <- readRDS("model.rds")
make_colors = c('#e6194b', '#f58231',  '#ffe119',
'#bcf60c','#3cb44b', '#008080',
'#aaffc3', '#4363d8', '#000075',
'#46f0f0', '#911eb4', '#e6beff',
'#f032e6', '#fabebe')
make_colors2 = c('#e6194b', '#f58231',  '#ffe119',
'#bcf60c','#3cb44b', '#008080',
'#aaffc3', '#4363d8', '#000075',
'#46f0f0', '#911eb4', '#e6beff',
'#f032e6', '#fabebe', 'black')
make_other = unique(ecars$Make2)
make_other = sort(make_other)
make_other[15] = 'Other'
make_other
make_other
library(MASS)
library(repr)
library(pals)
library(shinythemes)
library(plotly)
library(bslib)
library(ggpubr)
library(revealjs)
library(shiny)
ecars = read.csv('ecars.csv')
ecars_vars = ecars[,4:10]
ecars_make  = ecars %>% group_by(Make) %>%
filter(n()>=10)
most_makes = read.csv('most_makes.csv')
predicted_price = read.csv('predicted_price.csv')
makes = most_makes$Make
ecars$Make2 = ifelse(ecars$Make %in% makes, ecars$Make, "zOther")
make_other = unique(ecars$Make2)
make_other = sort(make_other)
make_other[15] = 'Other'
price_model_initial = lm(Price ~ Efficiency + Fast_charge +
Range + Top_speed +
Acceleration, data = ecars)
bc = boxCox(price_model_initial)
lambda = bc$x[which(bc$y == max(bc$y))]
model <- readRDS("model.rds")
make_colors = c('#e6194b', '#f58231',  '#ffe119',
'#bcf60c','#3cb44b', '#008080',
'#aaffc3', '#4363d8', '#000075',
'#46f0f0', '#911eb4', '#e6beff',
'#f032e6', '#fabebe')
make_colors2 = c('#e6194b', '#f58231',  '#ffe119',
'#bcf60c','#3cb44b', '#008080',
'#aaffc3', '#4363d8', '#000075',
'#46f0f0', '#911eb4', '#e6beff',
'#f032e6', '#fabebe', 'black')
make_other = unique(ecars$Make2)
plot(ecars[,4:10],
main = 'Comparison of all Quantitive Features')
library(extrafont)
install.packages('extrafont')
library(extrafont)
windowsFonts()
font_import()
library(extrafont)
font_import()
font_import()
ggplot(ecars, aes(x=!!input$var)) +
geom_histogram(color="black", fill="white", bins = 15)+
ggtitle('Distribution of Selected Feature')+
theme(plot.title = element_text(size=18, family= "Verdana"),
axis.title = element_text(size = 14))
ggplot(ecars, aes(x=Price)) +
geom_histogram(color="black", fill="white", bins = 15)+
ggtitle('Distribution of Selected Feature')+
theme(plot.title = element_text(size=18, family= "Verdana"),
axis.title = element_text(size = 14))
loadfonts(device="win")
library(extrafont)
fonts()
ggplot(ecars, aes(x=Price)) +
geom_histogram(color="black", fill="white", bins = 15)+
ggtitle('Distribution of Selected Feature')+
theme(plot.title = element_text(size=18, family= "Verdana"),
axis.title = element_text(size = 14))
ggplot(ecars, aes(x=Price)) +
geom_histogram(color="black", fill="white", bins = 15)+
ggtitle('Distribution of Selected Feature')+
theme(plot.title = element_text(size=18, family= "Sans Serif Collection"),
axis.title = element_text(size = 14))
plot_ly(
data = ecars_make,
x = ~Price,
y = ~Make,
type = "box",
color = ~Make,
colors = make_colors,
text = ~Car_name,
tooltip = c("x", "text"),
showlegend = FALSE
)%>%
layout(title = "Selected Feature (Makes with 10 + Models)",
yaxis = list(title = ''),
xaxis = list(title = ''))
ggplot(ecars, aes(x=Price)) +
geom_histogram(color="black", fill="white", bins = 15)+
ggtitle('Distribution of Selected Feature')+
theme(plot.title = element_text(size=18, family= "Lucida Sans"),
axis.title = element_text(size = 14))
ggplot(ecars, aes(x=Price)) +
geom_histogram(color="black", fill="white", bins = 15)+
ggtitle('Distribution of Selected Feature')+
theme(plot.title = element_text(size=18, family= "Garamond"),
axis.title = element_text(size = 14))
plot_ly(
data = ecars_make,
x = ~Price,
y = ~Make,
type = "box",
color = ~Make,
colors = make_colors,
text = ~Car_name,
tooltip = c("x", "text"),
showlegend = FALSE
)%>%
layout(title = "Selected Feature (Makes with 10 + Models)",
yaxis = list(title = ''),
xaxis = list(title = ''))
ggplot(ecars, aes(x=Price)) +
geom_histogram(color="black", fill="white", bins = 15)+
ggtitle('Distribution of Selected Feature')+
theme(plot.title = element_text(size=18, family= "Garamond"),
axis.title = element_text(size = 14))
plot_ly(
data = ecars_make,
x = ~Price,
y = ~Make,
type = "box",
color = ~Make,
colors = make_colors,
text = ~Car_name,
tooltip = c("x", "text"),
showlegend = FALSE
)%>%
layout(title = "Selected Feature (Makes with 10 + Models)",
yaxis = list(title = ''),
xaxis = list(title = ''))
ggplot(ecars, aes(x=Price)) +
geom_histogram(color="black", fill="white", bins = 15)+
ggtitle('Distribution of Selected Feature')+
theme(plot.title = element_text(size=18, family= "Cambria"),
axis.title = element_text(size = 14))
ggplot(ecars, aes(x=Price)) +
geom_histogram(color="black", fill="white", bins = 15)+
ggtitle('Distribution of Selected Feature')+
theme(plot.title = element_text(size=18, family= "Courier"),
axis.title = element_text(size = 14))
plot_ly(
data = ecars_make,
x = ~Price,
y = ~Make,
type = "box",
color = ~Make,
colors = make_colors,
text = ~Car_name,
tooltip = c("x", "text"),
showlegend = FALSE
)%>%
layout(title = "Selected Feature (Makes with 10 + Models)",
yaxis = list(title = ''),
xaxis = list(title = ''))
ggplot(ecars, aes(x=Price)) +
geom_histogram(color="black", fill="white", bins = 15)+
ggtitle('Distribution of Selected Feature')+
theme(plot.title = element_text(size=18, family= "Palatino"),
axis.title = element_text(size = 14))
plot_ly(
data = ecars_make,
x = ~Price,
y = ~Make,
type = "box",
color = ~Make,
colors = make_colors,
text = ~Car_name,
tooltip = c("x", "text"),
showlegend = FALSE
)%>%
layout(title = "Selected Feature (Makes with 10 + Models)",
yaxis = list(title = ''),
xaxis = list(title = ''))
ggplot(ecars, aes(x=Price)) +
geom_histogram(color="black", fill="white", bins = 15)+
ggtitle('Distribution of Selected Feature')+
theme(plot.title = element_text(size=18, family= "NimbusMon"),
axis.title = element_text(size = 14))
ggplot(ecars, aes(x=Price)) +
geom_histogram(color="black", fill="white", bins = 15)+
ggtitle('Distribution of Selected Feature')+
theme(plot.title = element_text(size=18, family= "Calibri"),
axis.title = element_text(size = 14))
plot_ly(
data = ecars_make,
x = ~Price,
y = ~Make,
type = "box",
color = ~Make,
colors = make_colors,
text = ~Car_name,
tooltip = c("x", "text"),
showlegend = FALSE
)%>%
layout(title = "Selected Feature (Makes with 10 + Models)",
yaxis = list(title = ''),
xaxis = list(title = ''))
ggplot(ecars, aes(x=Price)) +
geom_histogram(color="black", fill="white", bins = 15)+
ggtitle('Distribution of Selected Feature')+
theme(plot.title = element_text(size=18, family= "Calibri"),
axis.title = element_text(size = 14))
plot_ly(
data = ecars_make,
x = ~Price,
y = ~Make,
type = "box",
color = ~Make,
colors = make_colors,
text = ~Car_name,
tooltip = c("x", "text"),
showlegend = FALSE
)%>%
layout(title = "Selected Feature (Makes with 10 + Models)",
yaxis = list(title = ''),
xaxis = list(title = ''))
ggplot(ecars, aes(x=Price)) +
geom_histogram(color="black", fill="white", bins = 15)+
ggtitle('Distribution of Selected Feature')+
theme(plot.title = element_text(size=18, family= "Perpetua"),
axis.title = element_text(size = 14))
ggplot(ecars, aes(x=Price)) +
geom_histogram(color="black", fill="white", bins = 15)+
ggtitle('Distribution of Selected Feature')+
theme(plot.title = element_text(size=18, family= "Perpetua"),
axis.title = element_text(size = 14, family= "Perpetua"))
plot_ly(
data = ecars_make,
x = ~Price,
y = ~Make,
type = "box",
color = ~Make,
colors = make_colors,
text = ~Car_name,
tooltip = c("x", "text"),
showlegend = FALSE
)%>%
layout(title = "Selected Feature (Makes with 10 + Models)",
yaxis = list(title = ''),
xaxis = list(title = ''))
ggplot(ecars, aes(x=Price)) +
geom_histogram(color="black", fill="white", bins = 15)+
ggtitle('Distribution of Selected Feature')+
theme(plot.title = element_text(size=18, family= "Perpetua"),
axis.title = element_text(size = 14, family= "Perpetua"))
plot_ly(
data = ecars_make,
x = ~Price,
y = ~Make,
type = "box",
color = ~Make,
colors = make_colors,
text = ~Car_name,
tooltip = c("x", "text"),
showlegend = FALSE
)%>%
layout(title = "Selected Feature (Makes with 10 + Models)",
yaxis = list(title = ''),
xaxis = list(title = ''))
ggplot(ecars, aes(x=Price)) +
geom_histogram(color="black", fill="white", bins = 15)+
ggtitle('Distribution of Selected Feature')+
theme(plot.title = element_text(size=18, family= "Perpetua"),
axis.title = element_text(size = 14, family= "Perpetua"))
ggplot(ecars, aes(x=Price)) +
geom_histogram(color="black", fill="white", bins = 15)+
ggtitle('Distribution of Selected Feature')+
theme(plot.title = element_text(size=18, family= "Times"),
axis.title = element_text(size = 14, family= "Perpetua"))
ggplot(ecars, aes(x=Price)) +
geom_histogram(color="black", fill="white", bins = 15)+
ggtitle('Distribution of Selected Feature')+
theme(plot.title = element_text(size=18, family= "American Typewriter"),
axis.title = element_text(size = 14, family= "Perpetua"))
ggplot(ecars, aes(x=Price)) +
geom_histogram(color="black", fill="white", bins = 15)+
ggtitle('Distribution of Selected Feature')+
theme(plot.title = element_text(size=18, family= "Century"),
axis.title = element_text(size = 14, family= "Perpetua"))
plot_ly(
data = ecars_make,
x = ~Price,
y = ~Make,
type = "box",
color = ~Make,
colors = make_colors,
text = ~Car_name,
tooltip = c("x", "text"),
showlegend = FALSE
)%>%
layout(title = "Selected Feature (Makes with 10 + Models)",
yaxis = list(title = ''),
xaxis = list(title = ''))
ggplot(ecars, aes(x=Price)) +
geom_histogram(color="black", fill="white", bins = 15)+
ggtitle('Distribution of Selected Feature')+
theme(plot.title = element_text(size=18, family= "Century"),
axis.title = element_text(size = 14, family= "Perpetua"))
plot_ly(
data = ecars_make,
x = ~Price,
y = ~Make,
type = "box",
color = ~Make,
colors = make_colors,
text = ~Car_name,
tooltip = c("x", "text"),
showlegend = FALSE
)%>%
layout(title = "Selected Feature (Makes with 10 + Models)",
yaxis = list(title = ''),
xaxis = list(title = ''))
ggplot(ecars, aes(x=Price)) +
geom_histogram(color="black", fill="white", bins = 15)+
ggtitle('Distribution of Selected Feature')+
theme(plot.title = element_text(size=18, family= "Century"),
axis.title = element_text(size = 14, family= "Perpetua"))
output$histogram <- renderPlot({
ggplot(ecars, aes(x=!!input$var)) +
geom_histogram(color="black", fill="white", bins = 15)+
ggtitle('Distribution of Selected Feature')+
theme(plot.title = element_text(size=18, family= "Verdana"),
axis.title = element_text(size = 14))
})
plot_ly(
data = ecars_make,
x = ~Price,
y = ~Make,
type = "box",
color = ~Make,
colors = make_colors,
text = ~Car_name,
tooltip = c("x", "text"),
showlegend = FALSE
)%>%
layout(title = "Selected Feature (Makes with 10 + Models)",
yaxis = list(title = ''),
xaxis = list(title = ''))
ggplot(ecars, aes(x=Price)) +
geom_histogram(color="black", fill="white", bins = 15)+
ggtitle('Distribution of Selected Feature')+
theme(plot.title = element_text(size=18, family= "Georgia"),
axis.title = element_text(size = 14, family= "Perpetua"))
plot_ly(
data = ecars_make,
x = ~Price,
y = ~Make,
type = "box",
color = ~Make,
colors = make_colors,
text = ~Car_name,
tooltip = c("x", "text"),
showlegend = FALSE
)%>%
layout(title = "Selected Feature (Makes with 10 + Models)",
yaxis = list(title = ''),
xaxis = list(title = ''))
ggplot(ecars, aes(x=Price)) +
geom_histogram(color="black", fill="white", bins = 15)+
ggtitle('Distribution of Selected Feature')+
theme(plot.title = element_text(size=18, family= "Slab Serifc"),
axis.title = element_text(size = 14, family= "Perpetua"))
ggplot(ecars, aes(x=Price)) +
geom_histogram(color="black", fill="white", bins = 15)+
ggtitle('Distribution of Selected Feature')+
theme(plot.title = element_text(size=18, family= "Slab Serif"),
axis.title = element_text(size = 14, family= "Perpetua"))
plot_ly(
data = ecars_make,
x = ~Price,
y = ~Make,
type = "box",
color = ~Make,
colors = make_colors,
text = ~Car_name,
tooltip = c("x", "text"),
showlegend = FALSE
)%>%
layout(title = "Selected Feature (Makes with 10 + Models)",
yaxis = list(title = ''),
xaxis = list(title = ''))
ggplot(ecars, aes(x=Price)) +
geom_histogram(color="black", fill="white", bins = 15)+
ggtitle('Distribution of Selected Feature')+
theme(plot.title = element_text(size=18, family= "Open Sans"),
axis.title = element_text(size = 14, family= "Perpetua"))
ggplot(ecars, aes(x=Price)) +
geom_histogram(color="black", fill="white", bins = 15)+
ggtitle('Distribution of Selected Feature')+
theme(plot.title = element_text(size=18),
axis.title = element_text(size = 14, family= "Perpetua"))
ggplot(ecars, aes(x=Price)) +
geom_histogram(color="black", fill="white", bins = 15)+
ggtitle('Distribution of Selected Feature')+
theme(plot.title = element_text(size=18),
axis.title = element_text(size = 14, family= "Perpetua"))
plot_ly(
data = ecars_make,
x = ~Price,
y = ~Make,
type = "box",
color = ~Make,
colors = make_colors,
text = ~Car_name,
tooltip = c("x", "text"),
showlegend = FALSE
)%>%
layout(title = "Selected Feature (Makes with 10 + Models)",
yaxis = list(title = ''),
xaxis = list(title = ''))
ggplot(ecars, aes(x=Price)) +
geom_histogram(color="black", fill="white", bins = 15)+
ggtitle('Distribution of Selected Feature')+
theme(plot.title = element_text(size=18),
axis.title = element_text(size = 14, family= "Perpetua"))
plot_ly(
data = ecars_make,
x = ~Price,
y = ~Make,
type = "box",
color = ~Make,
colors = make_colors,
text = ~Car_name,
tooltip = c("x", "text"),
showlegend = FALSE
)%>%
layout(title = "Selected Feature (Makes with 10 + Models)",
yaxis = list(title = ''),
xaxis = list(title = ''))
ggplot(ecars, aes(x=Price)) +
geom_histogram(color="black", fill="white", bins = 15)+
ggtitle('Distribution of Selected Feature')+
theme(plot.title = element_text(size=18),
axis.title = element_text(size = 14, family= "Perpetua"))
plot_ly(
data = ecars_make,
x = ~Price,
y = ~Make,
type = "box",
color = ~Make,
colors = make_colors,
text = ~Car_name,
tooltip = c("x", "text"),
showlegend = FALSE
)%>%
layout(title = "Selected Feature (Makes with 10 + Models)",
yaxis = list(title = ''),
xaxis = list(title = ''))
ggplot(ecars, aes(x=Price)) +
geom_histogram(color="black", fill="white", bins = 15)+
ggtitle('Distribution of Selected Feature')+
theme(plot.title = element_text(size=18),
axis.title = element_text(size = 14, family= "Perpetua"))
ggplot(ecars, aes(x=Price)) +
geom_histogram(color="black", fill="white", bins = 15)+
ggtitle('Distribution of Selected Feature')+
theme(plot.title = element_text(size=18, family= "Open Sans"),
axis.title = element_text(size = 14, family= "Perpetua"))
fonts()
fonts()
lm_Price_TS = lm(Price ~ Top_speed, ecars)
summary(lm_Price_TS)
setwd("C:/Users/Natal/Documents/NYCDSA_Projects/Is-your-electric-car-overpriced-/Slidy_presentation")
setwd("C:/Users/Natal/Documents/NYCDSA_Projects/Is-your-electric-car-overpriced-/Price_prediction")
runApp()
